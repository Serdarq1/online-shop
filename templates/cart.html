{% include "base.html" %}
{% include "navbar.html" %}
<h1 class="mb-4 text-xl font-semibold ml-4">Your Cart</h1>

<div class="grid gap-6 lg:grid-cols-3 ml-4 mr-4">
  <section class="space-y-3 lg:col-span-2">
    {% if cart["items"] %}
      {% for item in cart["items"] %}
      <div class="flex items-center justify-between gap-3 rounded-xl border bg-white p-4">
        <div class="flex items-center gap-3">
          <img src="{{ item.image_url }}" alt="{{ item.name }}" class="size-16 rounded-md border object-cover" />
          <div>
            <p class="font-medium">{{ item.name }}</p>
            {% if item.size %}<p class="text-sm text-gray-600">Size: {{ item.size|upper }}</p>{% endif %}
            <form action="{{ url_for('remove_from_cart', item_id=item.id) }}" method="post" class="mt-1">
              <button class="text-sm text-gray-600 underline cursor-pointer">Remove</button>
            </form>
          </div>
        </div>
        <div class="flex items-center gap-2">
          <form action="{{ url_for('update_cart', item_id=item.id) }}" method="post" class="flex items-center gap-2">
            <input type="number" name="qty" min="1" value="{{ item.qty }}" class="w-20 rounded-md border px-2 py-1" />
            <button class="rounded-md border px-3 py-1.5 text-sm hover:bg-gray-50 cursor-pointer">Update</button>
          </form>
          <p class="w-24 text-right font-semibold">${{ '%.2f'|format(item.total_price) }}</p>
        </div>
      </div>
      {% endfor %}
    {% else %}
      
      <p class="text-sm text-gray-600">Your cart is empty.</p>
    {% endif %}
  </section>

  <aside class="space-y-3">
    <div class="rounded-xl border bg-white p-4">
      <h2 class="font-semibold">Order Summary</h2>
      {% if not cart['items'] %}
      <dl class="mt-2 space-y-1 text-sm">
        <div class="flex justify-between"><dt class="text-gray-600">Subtotal</dt><dd>$0</dd></div>
        <div class="flex justify-between"><dt class="text-gray-600">Shipping</dt><dd>$0</dd></div>
        <div class="flex justify-between"><dt class="text-gray-600">Tax</dt><dd>$0</dd></div>
        <div class="mt-2 flex justify-between border-t pt-2 text-base font-semibold"><dt>Total</dt><dd>$0</dd></div>
      </dl>
      {% else %}
      <dl class="mt-2 space-y-1 text-sm">
        <div class="flex justify-between"><dt class="text-gray-600">Subtotal</dt><dd>${{ '%.2f'|format(cart.subtotal) }}</dd></div>
        <div class="flex justify-between"><dt class="text-gray-600">Shipping</dt><dd>${{ cart.shipping > 0 and ( '%.2f'|format(cart.shipping)) or 'Free' }}</dd></div>
        <div class="flex justify-between"><dt class="text-gray-600">Tax</dt><dd>${{ '%.2f'|format(cart.tax) }}</dd></div>
        <div class="flex justify-between"><dt class="text-red-600">Discount</dt><dd>${{ '%.2f'|format((cart.total * 10 / 100 ))}}</dd></div>
        <div class="mt-2 flex justify-between border-t pt-2 text-base font-semibold"><dt>Total</dt><dd>${{ '%.2f'|format(cart.total) }}</dd></div>
      </dl>
      <a href="#" class="mt-3 block w-full rounded-md border px-4 py-2 text-center font-medium hover:bg-gray-50">Checkout</a>
      {% endif %}
    </div>
    <form class="flex" action="{{url_for('cart')}}" method="post">
        <div><input type="text" name="discount" placeholder="Discount Code" class="border border-black rounded-md p-2" /></div>
        <button type="submit" class="ml-4 px-2 py-1 cursor-pointer transition hover:bg-gray-100 border border-black rounded-md">Submit</button>
    </form>
  </aside>
</div>
